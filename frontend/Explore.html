<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Explore haunted histories and ghostly tales across cities worldwide.">
  <title>Haunted Histories</title>
  <link rel="stylesheet" href="./styles.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>

<body>

  <!-- Header -->
  <header class="main-header">
    <div class="container header-content">
      <h3 class="name">
        <img src="https://d28lcup14p4e72.cloudfront.net/239025/8059813/Eeriecast%20Logo%20Revamp.png" class="logo">
        Haunted Histories
      </h3>

      <nav class="nav-menu">
        <ul>
          <li><a href="/">Home</a></li>
          <li><a href="contact.html">Contact</a></li>
          <!-- Add Logout Button if user is logged in -->
          <li><a id="logout-button" onclick="logout()">Logout</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <!-- Hero Section -->
  <section class="hero">
    <video autoplay muted loop class="background-video">
      <source src="./videos/explore.mp4" type="video/mp4">
      Your browser does not support the video tag.
    </video>
    <div class="hero-content">
      <h2>Unravel Ghostly Mysteries</h2><br>
      <p>Step into the shadows of haunted heritage – from eerie ruins to the mysteries of ancient forts and forgotten
        castles.</p>
      <div class="city-selector">
        <label for="city-select">Select a City to Explore Haunted Locations:</label>
        <select id="city-select" onchange="showLocations()">
          <option value="" disabled selected>Select a destination...</option>
          <option value="vadodara">Vadodara</option>
        </select>

        <div id="location-list" style="display:none;">
          <label for="location-select">Select a Haunted Location:</label>
          <select id="location-select">
            <option value="" disabled selected>Select a location...</option>
          </select>
          <button id="explore-button" onclick="exploreLocation()">Explore Haunted Location</button>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="main-footer">
    <div class="container">
      <p>© 2024 Haunted Histories. All Rights Reserved.</p>
      <p>Designed with passion and a hint of spookiness.</p>
    </div>
  </footer>

  <script>
    async function checkAccess() {
      const response = await fetch('/api/auth/check-session', { credentials: 'include' });
      const data = await response.json();
      if (!data.loggedIn) {
        alert("You need to log in first!");
        window.location.href = 'login.html';
      }
    }

    async function logout() {
      const response = await fetch('/api/auth/logout', { method: 'POST', credentials: 'include' });
      const data = await response.json();
      if (data.message === 'Logged out successfully') {
        alert("You have been logged out!");
        window.location.href = 'index.html'; // Redirect to login page after logging out
      } else {
        alert("Logout failed. Please try again.");
      }
    }

    checkAccess(); // Ensure access check is performed on page load
  </script>

  <script src="./scripts.js"></script>
</body>

</html>